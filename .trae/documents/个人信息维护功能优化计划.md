# 个人信息维护功能优化计划

## 问题分析

### 1. 头像无法上传图片
- **现状**：头像区域只是一个显示姓名首字母的占位符，点击相机按钮没有实际功能
- **原因**：没有实现图片选择和上传逻辑

### 2. 保存按钮问题
- **现状**：保存按钮使用 `fixed bottom-0` 定位，可能被底部导航栏遮挡
- **原因**：ProfileEditView 是独立页面视图，但底部导航栏仍然显示，导致按钮被遮挡

## 解决方案

### 方案一：头像上传功能（使用 Base64 存储）

**优点**：无需额外配置 Supabase Storage，实现简单
**缺点**：大图片会增加数据库存储压力

**实现步骤**：
1. 在 User 类型中添加 `avatar?: string` 字段
2. 创建图片选择和裁剪逻辑
3. 将图片转为 Base64 存储到用户数据中
4. 显示时优先显示头像图片，否则显示姓名首字母

### 方案二：保存按钮位置调整

**实现步骤**：
1. 将保存按钮从 `fixed bottom-0` 改为页面内底部
2. 增加 `pb-24` 确保不被底部导航遮挡
3. 或者使用 `bottom-20` 避开底部导航栏高度

## 任务清单

### 任务 1：更新 User 类型定义
- 文件：`types.ts`
- 添加 `avatar?: string` 字段

### 任务 2：实现头像上传功能
- 文件：`components/mobile/views/ProfileEditView.tsx`
- 添加隐藏的 file input
- 实现图片选择和 Base64 转换
- 更新头像显示逻辑

### 任务 3：修复保存按钮显示
- 文件：`components/mobile/views/ProfileEditView.tsx`
- 调整按钮位置，避免被底部导航遮挡

### 任务 4：更新 updateUser 服务
- 文件：`services/supabaseService.ts`
- 确保 avatar 字段可以被保存

### 任务 5：验证功能
- 测试头像上传和显示
- 测试保存按钮点击
- 测试数据持久化

## 预期效果

```
┌─────────────────────────────────┐
│  个人信息                  [返回]│
├─────────────────────────────────┤
│       [📷 头像图片]             │
│      点击更换头像               │
├─────────────────────────────────┤
│  姓名 *                         │
│  [张三                    ]     │
│  ...                            │
├─────────────────────────────────┤
│  [      保存修改      ]         │  ← 按钮可见且可点击
└─────────────────────────────────┘
```
